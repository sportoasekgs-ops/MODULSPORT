{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"../../services/api.service\";\nimport * as i4 from \"@angular/common\";\nfunction BookingFormComponent_div_34_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"div\", 21)(2, \"div\", 22);\n    i0.ɵɵelement(3, \"input\", 23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 22);\n    i0.ɵɵelement(5, \"input\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 25)(7, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function BookingFormComponent_div_34_Template_button_click_7_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const i_r4 = restoredCtx.index;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.removeStudent(i_r4));\n    });\n    i0.ɵɵtext(8, \" Entfernen \");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const i_r4 = ctx.index;\n    i0.ɵɵproperty(\"formGroupName\", i_r4);\n  }\n}\nfunction BookingFormComponent_div_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.errorMessage, \" \");\n  }\n}\nfunction BookingFormComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.successMessage, \" \");\n  }\n}\nexport class BookingFormComponent {\n  constructor(route, router, fb, apiService) {\n    this.route = route;\n    this.router = router;\n    this.fb = fb;\n    this.apiService = apiService;\n    this.date = '';\n    this.period = 0;\n    this.weekday = '';\n    this.submitting = false;\n    this.errorMessage = '';\n    this.successMessage = '';\n    this.bookingForm = this.fb.group({\n      offer_type: ['sport', Validators.required],\n      offer_label: ['', Validators.required],\n      teacher_name: ['', Validators.required],\n      teacher_class: [''],\n      students: this.fb.array([])\n    });\n  }\n  ngOnInit() {\n    this.date = this.route.snapshot.paramMap.get('date') || '';\n    this.period = parseInt(this.route.snapshot.paramMap.get('period') || '0');\n    this.weekday = this.getWeekday(this.date);\n    this.addStudent();\n  }\n  get students() {\n    return this.bookingForm.get('students');\n  }\n  addStudent() {\n    this.students.push(this.fb.group({\n      name: ['', Validators.required],\n      klasse: ['', Validators.required]\n    }));\n  }\n  removeStudent(index) {\n    this.students.removeAt(index);\n  }\n  submitBooking() {\n    if (!this.bookingForm.valid) return;\n    this.submitting = true;\n    this.errorMessage = '';\n    this.successMessage = '';\n    const bookingData = {\n      date: this.date,\n      weekday: this.weekday,\n      period: this.period,\n      ...this.bookingForm.value\n    };\n    this.apiService.createBooking(bookingData).subscribe({\n      next: response => {\n        this.submitting = false;\n        this.successMessage = 'Buchung erfolgreich erstellt!';\n        setTimeout(() => {\n          this.router.navigate(['/my-bookings']);\n        }, 2000);\n      },\n      error: error => {\n        this.submitting = false;\n        this.errorMessage = error.error?.error || 'Fehler beim Erstellen der Buchung';\n      }\n    });\n  }\n  cancel() {\n    this.router.navigate(['/slots']);\n  }\n  getWeekday(dateStr) {\n    const date = new Date(dateStr);\n    const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n    return days[date.getDay()];\n  }\n  static {\n    this.ɵfac = function BookingFormComponent_Factory(t) {\n      return new (t || BookingFormComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.ApiService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: BookingFormComponent,\n      selectors: [[\"app-booking-form\"]],\n      decls: 44,\n      vars: 8,\n      consts: [[1, \"card\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"mb-3\"], [1, \"form-label\"], [\"formControlName\", \"offer_type\", 1, \"form-select\"], [\"value\", \"sport\"], [\"value\", \"games\"], [\"value\", \"outdoor\"], [\"value\", \"other\"], [\"type\", \"text\", \"formControlName\", \"offer_label\", \"placeholder\", \"z.B. Basketball, Fu\\u00DFball, etc.\", 1, \"form-control\"], [\"type\", \"text\", \"formControlName\", \"teacher_name\", 1, \"form-control\"], [\"type\", \"text\", \"formControlName\", \"teacher_class\", \"placeholder\", \"z.B. 5a, 6b, etc.\", 1, \"form-control\"], [\"formArrayName\", \"students\"], [\"class\", \"mb-2\", 3, \"formGroupName\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", \"mt-2\", 3, \"click\"], [1, \"d-flex\", \"gap-2\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"class\", \"alert alert-danger mt-3\", 4, \"ngIf\"], [\"class\", \"alert alert-success mt-3\", 4, \"ngIf\"], [1, \"mb-2\", 3, \"formGroupName\"], [1, \"row\"], [1, \"col-md-5\"], [\"type\", \"text\", \"formControlName\", \"name\", \"placeholder\", \"Name\", 1, \"form-control\"], [\"type\", \"text\", \"formControlName\", \"klasse\", \"placeholder\", \"Klasse\", 1, \"form-control\"], [1, \"col-md-2\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"alert\", \"alert-danger\", \"mt-3\"], [1, \"alert\", \"alert-success\", \"mt-3\"]],\n      template: function BookingFormComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n          i0.ɵɵtext(2, \"Slot buchen\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"p\");\n          i0.ɵɵtext(4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"form\", 1);\n          i0.ɵɵlistener(\"ngSubmit\", function BookingFormComponent_Template_form_ngSubmit_5_listener() {\n            return ctx.submitBooking();\n          });\n          i0.ɵɵelementStart(6, \"div\", 2)(7, \"label\", 3);\n          i0.ɵɵtext(8, \"Angebotsart\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(9, \"select\", 4)(10, \"option\", 5);\n          i0.ɵɵtext(11, \"Sport\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"option\", 6);\n          i0.ɵɵtext(13, \"Spiele\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(14, \"option\", 7);\n          i0.ɵɵtext(15, \"Outdoor\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"option\", 8);\n          i0.ɵɵtext(17, \"Sonstiges\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(18, \"div\", 2)(19, \"label\", 3);\n          i0.ɵɵtext(20, \"Angebotsbezeichnung\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(21, \"input\", 9);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(22, \"div\", 2)(23, \"label\", 3);\n          i0.ɵɵtext(24, \"Lehrkraft Name\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(25, \"input\", 10);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(26, \"div\", 2)(27, \"label\", 3);\n          i0.ɵɵtext(28, \"Klasse\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(29, \"input\", 11);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(30, \"div\", 2)(31, \"label\", 3);\n          i0.ɵɵtext(32, \"Sch\\u00FCler\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(33, \"div\", 12);\n          i0.ɵɵtemplate(34, BookingFormComponent_div_34_Template, 9, 1, \"div\", 13);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(35, \"button\", 14);\n          i0.ɵɵlistener(\"click\", function BookingFormComponent_Template_button_click_35_listener() {\n            return ctx.addStudent();\n          });\n          i0.ɵɵtext(36, \" + Sch\\u00FCler hinzuf\\u00FCgen \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(37, \"div\", 15)(38, \"button\", 16);\n          i0.ɵɵtext(39);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(40, \"button\", 17);\n          i0.ɵɵlistener(\"click\", function BookingFormComponent_Template_button_click_40_listener() {\n            return ctx.cancel();\n          });\n          i0.ɵɵtext(41, \" Abbrechen \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(42, BookingFormComponent_div_42_Template, 2, 1, \"div\", 18);\n          i0.ɵɵtemplate(43, BookingFormComponent_div_43_Template, 2, 1, \"div\", 19);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵtextInterpolate2(\"Datum: \", ctx.date, \" - \", ctx.period, \". Stunde\");\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"formGroup\", ctx.bookingForm);\n          i0.ɵɵadvance(29);\n          i0.ɵɵproperty(\"ngForOf\", ctx.students.controls);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"disabled\", !ctx.bookingForm.valid || ctx.submitting);\n          i0.ɵɵadvance(1);\n          i0.ɵɵtextInterpolate1(\" \", ctx.submitting ? \"Wird gespeichert...\" : \"Buchen\", \" \");\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.successMessage);\n        }\n      },\n      dependencies: [i4.NgForOf, i4.NgIf, i2.ɵNgNoValidate, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName, i2.FormGroupName, i2.FormArrayName],\n      encapsulation: 2\n    });\n  }\n}","map":{"version":3,"mappings":"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","names":["Validators","i0","BookingFormComponent","constructor","route","router","fb","apiService","bookingForm","group","offer_type","required","offer_label","teacher_name","teacher_class","students","array","ngOnInit","date","snapshot","paramMap","get","period","parseInt","weekday","getWeekday","addStudent","push","name","klasse","removeStudent","index","removeAt","submitBooking","valid","submitting","errorMessage","successMessage","bookingData","value","createBooking","subscribe","next","response","setTimeout","navigate","error","cancel","dateStr","Date","days","getDay","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/home/runner/workspace/frontend/src/app/components/booking-form/booking-form.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { FormBuilder, FormGroup, Validators, FormArray } from '@angular/forms';\nimport { ApiService } from '../../services/api.service';\n\n@Component({\n  selector: 'app-booking-form',\n  template: `\n    <div class=\"card\">\n      <h2>Slot buchen</h2>\n      <p>Datum: {{ date }} - {{ period }}. Stunde</p>\n      \n      <form [formGroup]=\"bookingForm\" (ngSubmit)=\"submitBooking()\">\n        <div class=\"mb-3\">\n          <label class=\"form-label\">Angebotsart</label>\n          <select class=\"form-select\" formControlName=\"offer_type\">\n            <option value=\"sport\">Sport</option>\n            <option value=\"games\">Spiele</option>\n            <option value=\"outdoor\">Outdoor</option>\n            <option value=\"other\">Sonstiges</option>\n          </select>\n        </div>\n        \n        <div class=\"mb-3\">\n          <label class=\"form-label\">Angebotsbezeichnung</label>\n          <input type=\"text\" class=\"form-control\" formControlName=\"offer_label\" \n                 placeholder=\"z.B. Basketball, Fußball, etc.\">\n        </div>\n        \n        <div class=\"mb-3\">\n          <label class=\"form-label\">Lehrkraft Name</label>\n          <input type=\"text\" class=\"form-control\" formControlName=\"teacher_name\">\n        </div>\n        \n        <div class=\"mb-3\">\n          <label class=\"form-label\">Klasse</label>\n          <input type=\"text\" class=\"form-control\" formControlName=\"teacher_class\"\n                 placeholder=\"z.B. 5a, 6b, etc.\">\n        </div>\n        \n        <div class=\"mb-3\">\n          <label class=\"form-label\">Schüler</label>\n          <div formArrayName=\"students\">\n            <div *ngFor=\"let student of students.controls; let i = index\" [formGroupName]=\"i\" class=\"mb-2\">\n              <div class=\"row\">\n                <div class=\"col-md-5\">\n                  <input type=\"text\" class=\"form-control\" formControlName=\"name\" placeholder=\"Name\">\n                </div>\n                <div class=\"col-md-5\">\n                  <input type=\"text\" class=\"form-control\" formControlName=\"klasse\" placeholder=\"Klasse\">\n                </div>\n                <div class=\"col-md-2\">\n                  <button type=\"button\" class=\"btn btn-danger\" (click)=\"removeStudent(i)\">\n                    Entfernen\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <button type=\"button\" class=\"btn btn-secondary mt-2\" (click)=\"addStudent()\">\n            + Schüler hinzufügen\n          </button>\n        </div>\n        \n        <div class=\"d-flex gap-2\">\n          <button type=\"submit\" class=\"btn btn-primary\" [disabled]=\"!bookingForm.valid || submitting\">\n            {{ submitting ? 'Wird gespeichert...' : 'Buchen' }}\n          </button>\n          <button type=\"button\" class=\"btn btn-secondary\" (click)=\"cancel()\">\n            Abbrechen\n          </button>\n        </div>\n        \n        <div *ngIf=\"errorMessage\" class=\"alert alert-danger mt-3\">\n          {{ errorMessage }}\n        </div>\n        \n        <div *ngIf=\"successMessage\" class=\"alert alert-success mt-3\">\n          {{ successMessage }}\n        </div>\n      </form>\n    </div>\n  `,\n  styles: []\n})\nexport class BookingFormComponent implements OnInit {\n  date: string = '';\n  period: number = 0;\n  weekday: string = '';\n  bookingForm: FormGroup;\n  submitting: boolean = false;\n  errorMessage: string = '';\n  successMessage: string = '';\n\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private fb: FormBuilder,\n    private apiService: ApiService\n  ) {\n    this.bookingForm = this.fb.group({\n      offer_type: ['sport', Validators.required],\n      offer_label: ['', Validators.required],\n      teacher_name: ['', Validators.required],\n      teacher_class: [''],\n      students: this.fb.array([])\n    });\n  }\n\n  ngOnInit(): void {\n    this.date = this.route.snapshot.paramMap.get('date') || '';\n    this.period = parseInt(this.route.snapshot.paramMap.get('period') || '0');\n    this.weekday = this.getWeekday(this.date);\n    \n    this.addStudent();\n  }\n\n  get students(): FormArray {\n    return this.bookingForm.get('students') as FormArray;\n  }\n\n  addStudent(): void {\n    this.students.push(this.fb.group({\n      name: ['', Validators.required],\n      klasse: ['', Validators.required]\n    }));\n  }\n\n  removeStudent(index: number): void {\n    this.students.removeAt(index);\n  }\n\n  submitBooking(): void {\n    if (!this.bookingForm.valid) return;\n    \n    this.submitting = true;\n    this.errorMessage = '';\n    this.successMessage = '';\n    \n    const bookingData = {\n      date: this.date,\n      weekday: this.weekday,\n      period: this.period,\n      ...this.bookingForm.value\n    };\n    \n    this.apiService.createBooking(bookingData).subscribe({\n      next: (response) => {\n        this.submitting = false;\n        this.successMessage = 'Buchung erfolgreich erstellt!';\n        setTimeout(() => {\n          this.router.navigate(['/my-bookings']);\n        }, 2000);\n      },\n      error: (error) => {\n        this.submitting = false;\n        this.errorMessage = error.error?.error || 'Fehler beim Erstellen der Buchung';\n      }\n    });\n  }\n\n  cancel(): void {\n    this.router.navigate(['/slots']);\n  }\n\n  private getWeekday(dateStr: string): string {\n    const date = new Date(dateStr);\n    const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n    return days[date.getDay()];\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}